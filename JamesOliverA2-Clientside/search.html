<!DOCTYPE html>


<!-- langauge set -->
<html lang="en">

<head>
	<!-- font size set -->
	<meta charset="utf-8">
	
	<!-- tab text set -->
	<title>Search - Fundraisers For a Better World</title>

	<!-- style sheet link  -->
	<link rel="stylesheet" href="style.css" type="text/css" media="screen" />
</head>

<body>


<!-- menu -->
<div id="header-wrapper">
	<header>
		<div id="menu">
			<ul>
				<li><a href="/">Home</a></li>
				<li class="current_page_item"><a href="">Search Fundraisers</a></li>		
			</ul>
		</div>

	</header>	
</div>



<!-- page content start-->
<div id="page">

	<div id="logo">
		<!-- page heading -->
		<h1>Fundraisers For a Better World</h1>
	</div>
	
	<hr/>
	
	<div id="content">
		
		<!-- Title box-->
		<div class="post">
			<h2 class="title">Search</h2>
		</div>
		
		<!-- search bar box -->
		<div class="post">			
			<div class="search-container">
				<label for="search">Search by:</label>
				
				<!-- Search option checkbox's -->
				<div class="checkbox-group">
	
					<div class="checkbox-item">
						<input type="checkbox" id="city" name="city"> 
						<label for="city">City</label>
					</div>
					<div class="checkbox-item">
						<input type="checkbox" id="organizer" name="organizer"> 
						<label for="organizer">Organizer</label>
					</div>
					<div class="checkbox-item">
						 <label for="category">Category:</label>
					<select id="category" name="category">
						<option value="">--Please choose an option--</option>
						<option value="Community">Community</option>
						<option value="Arts">Arts</option>
						<option value="Environment">Environment</option>
						<option value="Health">Health</option>
						<option value="Animal welfare">Animal Welfare</option>
					</select>
					</div>
					
					
					<!-- Search box and button-->
					<input type="text" id="search" name="search" placeholder="Type your search here..." required>
					<input type="button" value="Search" onclick="searchCheck()">
					
					<!-- Clear button -->
					<input type="button" value="clear filters" onclick="clearFilters()">
				</div>	
			</div>
		</div>
		
		<!-- results of search box -->
		<div class="postSearch" style="display: none;">
			<!-- Your search results go here -->
			<h2 class="title">Search Results</h2>
			<div id="results">
			</div>
		</div>	
	</div>
	
		

		
	
<div style="clear: both;">&nbsp;</div>
	
</div>
		
			
			
    
<script>
					function searchCheck() 
					{
							const cityChecked = document.getElementById("city").checked;
							const orgChecked = document.getElementById("organizer").checked; 
							const searchTerm = document.getElementById('search').value.trim(); 
							const catSelect = document.getElementById("category").value; 

							// Check if the search term is empty
							if (searchTerm === "")
							{
								alert("Please enter a search term");
								return; 
							}

							
							if (cityChecked) 
							{
								showFundraisersByCity(searchTerm);
							}

							
							if (cityChecked && orgChecked && catSelect === "") 
							{
								alert("Please select a category filter");
								return; 
							}

						}


			
		function showFundraisersByCity(city) {
        const postDiv = document.querySelector('.postSearch');
        postDiv.style.display = 'block'; 
        const dataDiv = document.getElementById('results');
        dataDiv.innerHTML = ""; // Clear previous results

        fetch(`http://localhost:8080/api/crowdfunding_db/${encodeURIComponent(city)}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error("Network response was not ok");
                }
                return response.json();
            })
            .then(data => {
                if (Array.isArray(data) && data.length > 0) {
                    data.forEach(fundraiser => {
                        const header = document.createElement("h3");
                        header.textContent = `${fundraiser.ORGANIZER} - ${fundraiser.CAPTION}`;

                        const cityP = document.createElement("p");
                        cityP.textContent = `City: ${fundraiser.CITY}`;

                        const targetP = document.createElement("p");
                        targetP.textContent = `Target Funds: $${fundraiser.TARGET_FUNDING}`;

                        const currentP = document.createElement("p");
                        currentP.textContent = `Current Funds: $${fundraiser.CURRENT_FUNDING}`;

                        const stateP = document.createElement("p");
                        stateP.textContent = `Active: ${fundraiser.ACTIVE === 1 ? 'Yes' : 'Currently Not Active'}`;

                        const idP = document.createElement("p");
                        idP.textContent = `ID: ${fundraiser.FUNDRAISER_ID}`;

                        // Append in order of display
                        dataDiv.appendChild(header);
                        dataDiv.appendChild(cityP);
                        dataDiv.appendChild(targetP);
                        dataDiv.appendChild(currentP);
                        dataDiv.appendChild(stateP);
                        dataDiv.appendChild(idP);
                    });
                } else {
                    dataDiv.textContent = "No fundraisers available for this city.";
                }
            })
            .catch(error => {
                console.error("Error fetching data:", error);
                dataDiv.textContent = "Failed to load data.";
            });
    }

    function clearFilters() {
        const checkboxes = document.querySelectorAll('.checkbox-group input[type="checkbox"]');
        checkboxes.forEach(checkbox => {
            checkbox.checked = false;
        });
        document.getElementById("category").value = "";
        document.getElementById("search").value = ""; // Clear the search input
        document.querySelector('.postSearch').style.display = 'none'; // Hide results
        document.getElementById('results').innerHTML = ""; // Clear results
    }
				
			
</script>
	
	


<!-- footer text -->
<div style="clear: both;">&nbsp;</div>
<footer>
		<p>Copyright (c) 2024. All rights reserved. Design by James Oliver</p>
</footer>



</body>
</html>

</html>
			
	
	